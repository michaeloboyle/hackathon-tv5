# SQLx Offline Mode Cache

This directory contains cached query metadata for SQLx offline compilation mode.

## Generation Instructions

To generate the SQLx query cache, run the following commands with a PostgreSQL database available:

```bash
# Option 1: Using the dev-setup script
./scripts/dev-setup.sh

# Option 2: Manual generation
export DATABASE_URL="postgres://postgres:postgres@localhost:5432/media_gateway"

# Create database and run migrations
cargo sqlx database create
cargo sqlx migrate run

# Generate query cache for all crates
cargo sqlx prepare --workspace

# Or for individual crates
cargo sqlx prepare --package media-gateway-core
cargo sqlx prepare --package media-gateway-auth
cargo sqlx prepare --package media-gateway-discovery
cargo sqlx prepare --package media-gateway-sona
cargo sqlx prepare --package media-gateway-sync
cargo sqlx prepare --package media-gateway-ingestion
cargo sqlx prepare --package media-gateway-playback
```

## CI/CD Integration

The CI/CD pipeline is configured to use `SQLX_OFFLINE=true` which reads from this cache.

When adding new SQL queries:
1. Run `cargo sqlx prepare --workspace` locally with a database
2. Commit the generated `.sqlx/*.json` files
3. CI will use these cached queries for offline compilation

## Files

- `*.json` - Cached query metadata (auto-generated)
- `db.json` - Database type indicator

Generated by BATCH_009 TASK-002.
